# 1 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c"
# 1 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c" 1
# 1 "<built-in>" 1
# 1 "<built-in>" 3
# 149 "<built-in>" 3
# 1 "<command line>" 1
# 1 "<built-in>" 2
# 1 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c" 2
# 1 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h" 1
# 10 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h"
# 1 "/nas/ei/share/tools/xilinx/Vivado/2019.1/lnx64/tools/clang/bin/../lib/clang/3.1/include/stdint.h" 1 3
# 33 "/nas/ei/share/tools/xilinx/Vivado/2019.1/lnx64/tools/clang/bin/../lib/clang/3.1/include/stdint.h" 3
# 1 "/usr/include/stdint.h" 1 3 4
# 26 "/usr/include/stdint.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/libc-header-start.h" 1 3 4
# 33 "/usr/include/x86_64-linux-gnu/bits/libc-header-start.h" 3 4
# 1 "/usr/include/features.h" 1 3 4
# 402 "/usr/include/features.h" 3 4
# 1 "/usr/include/stdc-predef.h" 1 3 4
# 403 "/usr/include/features.h" 2 3 4
# 424 "/usr/include/features.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/sys/cdefs.h" 1 3 4
# 427 "/usr/include/x86_64-linux-gnu/sys/cdefs.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/wordsize.h" 1 3 4
# 428 "/usr/include/x86_64-linux-gnu/sys/cdefs.h" 2 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/long-double.h" 1 3 4
# 429 "/usr/include/x86_64-linux-gnu/sys/cdefs.h" 2 3 4
# 425 "/usr/include/features.h" 2 3 4
# 448 "/usr/include/features.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/gnu/stubs.h" 1 3 4
# 10 "/usr/include/x86_64-linux-gnu/gnu/stubs.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/gnu/stubs-64.h" 1 3 4
# 11 "/usr/include/x86_64-linux-gnu/gnu/stubs.h" 2 3 4
# 449 "/usr/include/features.h" 2 3 4
# 34 "/usr/include/x86_64-linux-gnu/bits/libc-header-start.h" 2 3 4
# 27 "/usr/include/stdint.h" 2 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/types.h" 1 3 4
# 27 "/usr/include/x86_64-linux-gnu/bits/types.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/wordsize.h" 1 3 4
# 28 "/usr/include/x86_64-linux-gnu/bits/types.h" 2 3 4


typedef unsigned char __u_char;
typedef unsigned short int __u_short;
typedef unsigned int __u_int;
typedef unsigned long int __u_long;


typedef signed char __int8_t;
typedef unsigned char __uint8_t;
typedef signed short int __int16_t;
typedef unsigned short int __uint16_t;
typedef signed int __int32_t;
typedef unsigned int __uint32_t;

typedef signed long int __int64_t;
typedef unsigned long int __uint64_t;







typedef long int __quad_t;
typedef unsigned long int __u_quad_t;







typedef long int __intmax_t;
typedef unsigned long int __uintmax_t;
# 130 "/usr/include/x86_64-linux-gnu/bits/types.h" 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/typesizes.h" 1 3 4
# 131 "/usr/include/x86_64-linux-gnu/bits/types.h" 2 3 4


typedef unsigned long int __dev_t;
typedef unsigned int __uid_t;
typedef unsigned int __gid_t;
typedef unsigned long int __ino_t;
typedef unsigned long int __ino64_t;
typedef unsigned int __mode_t;
typedef unsigned long int __nlink_t;
typedef long int __off_t;
typedef long int __off64_t;
typedef int __pid_t;
typedef struct { int __val[2]; } __fsid_t;
typedef long int __clock_t;
typedef unsigned long int __rlim_t;
typedef unsigned long int __rlim64_t;
typedef unsigned int __id_t;
typedef long int __time_t;
typedef unsigned int __useconds_t;
typedef long int __suseconds_t;

typedef int __daddr_t;
typedef int __key_t;


typedef int __clockid_t;


typedef void * __timer_t;


typedef long int __blksize_t;




typedef long int __blkcnt_t;
typedef long int __blkcnt64_t;


typedef unsigned long int __fsblkcnt_t;
typedef unsigned long int __fsblkcnt64_t;


typedef unsigned long int __fsfilcnt_t;
typedef unsigned long int __fsfilcnt64_t;


typedef long int __fsword_t;

typedef long int __ssize_t;


typedef long int __syscall_slong_t;

typedef unsigned long int __syscall_ulong_t;



typedef __off64_t __loff_t;
typedef char *__caddr_t;


typedef long int __intptr_t;


typedef unsigned int __socklen_t;




typedef int __sig_atomic_t;
# 28 "/usr/include/stdint.h" 2 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/wchar.h" 1 3 4
# 29 "/usr/include/stdint.h" 2 3 4
# 1 "/usr/include/x86_64-linux-gnu/bits/wordsize.h" 1 3 4
# 30 "/usr/include/stdint.h" 2 3 4




# 1 "/usr/include/x86_64-linux-gnu/bits/stdint-intn.h" 1 3 4
# 24 "/usr/include/x86_64-linux-gnu/bits/stdint-intn.h" 3 4
typedef __int8_t int8_t;
typedef __int16_t int16_t;
typedef __int32_t int32_t;
typedef __int64_t int64_t;
# 35 "/usr/include/stdint.h" 2 3 4


# 1 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h" 1 3 4
# 24 "/usr/include/x86_64-linux-gnu/bits/stdint-uintn.h" 3 4
typedef __uint8_t uint8_t;
typedef __uint16_t uint16_t;
typedef __uint32_t uint32_t;
typedef __uint64_t uint64_t;
# 38 "/usr/include/stdint.h" 2 3 4





typedef signed char int_least8_t;
typedef short int int_least16_t;
typedef int int_least32_t;

typedef long int int_least64_t;






typedef unsigned char uint_least8_t;
typedef unsigned short int uint_least16_t;
typedef unsigned int uint_least32_t;

typedef unsigned long int uint_least64_t;
# 68 "/usr/include/stdint.h" 3 4
typedef signed char int_fast8_t;

typedef long int int_fast16_t;
typedef long int int_fast32_t;
typedef long int int_fast64_t;
# 81 "/usr/include/stdint.h" 3 4
typedef unsigned char uint_fast8_t;

typedef unsigned long int uint_fast16_t;
typedef unsigned long int uint_fast32_t;
typedef unsigned long int uint_fast64_t;
# 97 "/usr/include/stdint.h" 3 4
typedef long int intptr_t;


typedef unsigned long int uintptr_t;
# 111 "/usr/include/stdint.h" 3 4
typedef __intmax_t intmax_t;
typedef __uintmax_t uintmax_t;
# 34 "/nas/ei/share/tools/xilinx/Vivado/2019.1/lnx64/tools/clang/bin/../lib/clang/3.1/include/stdint.h" 2 3
# 11 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h" 2
# 50 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h"
struct AES_ctx {
  uint8_t RoundKey[176];

  uint8_t Iv[16];

};

void AES_init_ctx(struct AES_ctx *ctx, const uint8_t *key);

void AES_init_ctx_iv(struct AES_ctx *ctx, const uint8_t *key,
                     const uint8_t *iv);
void AES_ctx_set_iv(struct AES_ctx *ctx, const uint8_t *iv);






void AES_ECB_encrypt(const struct AES_ctx *ctx, uint8_t *buf);
void AES_ECB_decrypt(const struct AES_ctx *ctx, uint8_t *buf);
# 79 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h"
void AES_CBC_encrypt_buffer(struct AES_ctx *ctx, uint8_t *buf, uint32_t length);
void AES_CBC_decrypt_buffer(struct AES_ctx *ctx, uint8_t *buf, uint32_t length);
# 92 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/../c_src/aes.h"
void AES_CTR_xcrypt_buffer(struct AES_ctx *ctx, uint8_t *buf, uint32_t length);
# 2 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c" 2
# 1 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.h" 1





typedef enum CRYPTDIR{
    ENC = 0,
    DEC = 1
} crpytdir_t;

void aes16_bidir(uint32_t key[4], uint32_t inout[4], uint32_t iv[4]);
# 3 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c" 2







void aes16_bidir(uint32_t key[4], uint32_t inout[4], uint32_t iv[4]){

#pragma HLS ARRAY_PARTITION variable=inout complete dim=1
#pragma HLS ARRAY_PARTITION variable=key complete dim=1
#pragma HLS ARRAY_PARTITION variable=iv complete dim=1

 uint8_t _key[16];
 uint8_t _text[16];
 uint8_t _iv[16];
    struct AES_ctx ctx;
 int i;
 int k;

 for(i = 0; i< 4; ++i){
  for (k = 0; k<4;++k){
   _key[i*4 +k] = (key[i] >>(8*k) );
   _text[i*4 +k] = (inout[i] >>(8*k) );
   _iv[i*4 +k] = (iv[i] >>(8*k) );
  }
 }
# 51 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c"
    AES_init_ctx_iv(&ctx, _key, _iv);
    AES_CTR_xcrypt_buffer(&ctx, _text, 16);

 for(i = 0; i< 4; ++i){
  inout[i] = ((uint32_t)(_text[i*4+3]) <<24) |
                    ((uint32_t)(_text[i*4+2]) <<16) |
                    ((uint32_t)(_text[i*4+1]) << 8) |
                    ((uint32_t)(_text[i*4+0]) << 0) ;
  iv[i] = ((uint32_t)(ctx.Iv[i*4+3]) <<24) |
                    ((uint32_t)(ctx.Iv[i*4+2]) <<16) |
                    ((uint32_t)(ctx.Iv[i*4+1]) << 8) |
                    ((uint32_t)(ctx.Iv[i*4+0]) << 0) ;
 }
# 74 "/nas/ei/share/TUEIEDA/LabSDS/WS20/ge46bod/lab3_aes_hls/hls/top_aes.c"
}
